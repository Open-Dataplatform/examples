import pandas as pd
from osiris.apis.egress import Egress
from osiris.core.azure_client_authorization import ClientAuthorization
from configparser import ConfigParser


config = ConfigParser()
config.read('conf.ini')

access_token = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Imwzc1EtNTBjQ0g0eEJWWkxIVEd3blNSNzY4MCIsImtpZCI6Imwzc1EtNTBjQ0g0eEJWWkxIVEd3blNSNzY4MCJ9.eyJhdWQiOiJodHRwczovL3N0b3JhZ2UuYXp1cmUuY29tIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvZjc2MTkzNTUtNmM2Ny00MTAwLTlhNzgtMTg0N2YzMDc0MmUyLyIsImlhdCI6MTYzMjM5NTY1NCwibmJmIjoxNjMyMzk1NjU0LCJleHAiOjE2MzIzOTk1NTQsImFjciI6IjEiLCJhaW8iOiJFMlpnWUdoNzhXRERwaTdsRzhiTmIvZzA3UDdwMjBYN05FL2FZZWsreVhiakxKM1M5WjRBIiwiYW1yIjpbInB3ZCJdLCJhcHBpZCI6ImQ5Y2Q1MjBlLTIzMTctNGRiNi1hNWFlLTc3ZjA5NDkwODVhZiIsImFwcGlkYWNyIjoiMCIsImZhbWlseV9uYW1lIjoiVGhvcmJlayIsImdpdmVuX25hbWUiOiJSdW5lIiwiZ3JvdXBzIjpbImY4NzdiYTAzLTU5NmYtNDZjOS05MTVhLTc4ZmI0MjlmYjQ2YyIsImYwM2MyYWQ5LTExYTYtNDAyMS04MTNhLWIxMjQ3NDdkMDAwYSIsIjE5ZTIyMDU4LTk5N2UtNGNhYy04NDI1LWFjNTEwNGMxMjYyMiIsIjY5OWFkNGFhLWU3ZmEtNDNjZS04MzNlLTc4NWYyODcwZmY5OSIsImRjNzM2OWU2LThhZjQtNGE2Mi05NzVlLTgwMzUxYzQ1MDFjMyIsIjYxYzc0ZDE0LTk1NTMtNDM1MS1hZjRhLWRlMDNiOTJjMmZkYiIsIjgzMGI2MTYwLTBiYzctNDAzYy04NTVmLWZkZTcyYTJhYjZiYyIsIjE0OTU5ZDUxLWIwMzMtNGUyNS1hZDg1LTIxYTNkM2Q2ZDMyMiIsIjU1OWNkMjVlLWRkMTAtNGI2NS1iZDViLTQwYTBjNTZlNmM5ZCIsIjY0OWVkY2RkLThlN2MtNGIwZC1iYmM4LTEyMWEzM2U5YWQzNCIsIjk2NTRiMzI2LTI4ODEtNDhmMS04OWI2LTc1MDRjNTJmNDZkOCIsIjg0ZmY5ZTBlLWRlMTgtNGVkOS04OTA1LTVlNjVmMmZkOWEyYSIsImRhNjljMjJiLTFhYjAtNDBkYS05NTc5LTAwYjdjMmFlNTI1YyIsImRlYTA4MzUxLTcxZmItNDg1My1iYzRkLTNjZDZiNzU0YTI2NSIsIjAyYWQ4YmNiLTYwYzYtNDk2OC1iYzUxLTIwNjdmMmFlODgxNiIsImNmNmM0MWUwLWI4MzEtNGU1NS1iZWE3LTkwZjIyYWE3NDg5OCIsImRkZmM3YThkLTQ4MjEtNDFlYy1hNGM1LTY2Nzg4ZmY2MmRmOSIsImRmMTM0YzJkLWYyM2EtNGNmZC1hMWM4LWViNTI4MzI1MmJkMCIsImQ3ZjI2YTczLTlhOTgtNDY0OC05NWJhLTQwMjVmNTQzZjVkZCIsIjA4ZWZmMDJlLTQxMDItNDVmNy1iMGI5LWE1Mjc1OGFjM2E2YSIsIjcwYjhjYjdjLWNmOGMtNDgwOC04MjBiLWIxNDhiZjhiYTUyZiIsImFhNDJmYTAyLWIyMDItNGRiNS05NjM5LTIzNTliMjMzYTgyMiIsImJkOTExMmE3LTEyMDctNGFlNC1iZGY2LWM4YjE3ZWY0NmJiNyIsIjJhNTNhZmJkLTAwZDgtNDQ5NC05NzYyLWE4N2NlZTg5MWE2YSIsImE0OTUxOTg3LTUyYTUtNGVlZi04Y2UzLTU4Y2M3ODY4MDY0MiIsImI5NTA1ODMxLWExZmMtNGIyNi1iNmJjLTFjMTEzYjlhMWNlNyIsIjkxYzcyOGRiLTIxOTctNGM0My04MGZmLTRhNWQ5MGVhZTUzYSIsIjRiNDhmZDY4LTZkNDMtNDdkYy04NDE4LTFmMzBmZTQ4ZWE0MSIsImY3ZmUyMmJiLTllMWUtNGRkZC04YTcwLTFjMTQ0YzFlNWZkZSIsIjc1NWM2N2YzLTA1NGMtNDU5MC1iNmVhLWU5ZmNiNjg1YTIyZiIsImJiY2VkZWI2LWRhMTctNGY4ZC1hZDdhLTg0ZWI2ODcxZmUxYyIsIjg3YmZiOTI0LWVhZmEtNGY0Yy1iMzczLWJiNjE4YzgzOTNkNyIsImY4YjgyNDk4LTJkMTgtNGRkYy05OGFiLTEzZjViNTBjODBhOCIsIjc1OWRmMzU5LTdmMDYtNGIzOS1iZDkzLTZmN2UxODAyYTBiYyIsIjNiMDYwNzEzLTM2MDMtNDYwNC1iMzIyLTI0NDA4MzU0YTFjMSIsIjhhMjdjOGJhLWZjMDItNDA4Ny04NTczLTRlNDA1ZTQxYjZiYyIsImVlZGQyOTQ2LTAwYjYtNDFlNi1hNjUwLTY0NWI1ZTU3NDVjMyIsIjk4YzhhNDQ5LTYxMTgtNDY1Yi05MmEwLWZhMzI1NzRhOTUxYiIsIjljMTYxZGMyLTQ3NTEtNGY3Ni05MDI2LTEzOTAwYzcwYzBjMiIsImNmN2Y0NGI1LTU0M2EtNGFlYS1hMTc0LTQ5MWZlYWNhZDdmOSIsIjgyOGIzYTBmLTNjNTgtNGYwNi05NGE5LWYxYjEyYmI5OTJiZCIsIjc2NDg0YmU5LTNhZTYtNDQ3Ny1iZDZhLWFhYzdkMjQ2Zjg0YyIsIjc2OGI0MTAxLTE4NGMtNGNjNC1hNGUyLTgzM2JhNGUxZTc1OCIsIjE5YzY4YTEyLTJhN2MtNDIyNS04ZjViLWYwMWYxOTZlMWY5OCIsImM2ODkyZGY0LTVjNDUtNGM3YS04MTQ4LWUxYjkxMTZiNjIwMiIsIjgzOTBkODdkLTM0YTYtNDY1NC1iMmYxLWQ5NmE2YzQ4YTdmZCIsIjgyNzcyZmI1LWVmYjktNDY2ZS04NTRiLTA3ZjZkMTJjNTRlZSIsIjM1NGM3NjIxLTY3MGMtNDM4ZC05NzE1LTRiNzdkMDlmZWQ2MyIsIjIzOWJhZGZhLTk4YjEtNGUyMS1iYjQwLWU4MjQxYzQzMzJjYSIsImY2MWRjNzFmLTE1OWYtNDA2Yy04YzUyLTQ3YzNiNmNiNjhmZSIsIjliZjg1YTg0LTMyMDMtNDhhYy05MDMzLWIzZTllOGJlMWI1OSIsImI1ZTk3ZmQwLTE4YzMtNGM5Yy1hNDk0LTU1YWFhMzY5NGVjOSIsIjE3NGFhZmYzLTNiOTYtNDY1Mi05ZjU0LTJlNzQ1YzliYzQwMyIsIjQ4MWRlN2YzLWJmYWQtNDA3MC1iYWVjLTgxMjNhNmMzNmY5NSIsIjgwY2M3NGYzLTAyYTMtNDZkMS05NGU2LTRhNWI4MWE4OTY5MCIsIjA4YTI2ZDRkLWI0NmEtNGE2Ny1iNTY0LTYzOGJjYmU2YmY0ZiIsImUwZjNkOGNjLTE5MGYtNDIyYy05MTQ5LTA4OWY1ZWUwYjYzOSIsIjdhMmEzMGUyLTE1YmEtNGE0My04NGM3LTU3NGZiM2JlOWZlYSIsIjIzYzlmNTllLWFlZTAtNGEyMC05NzA2LTNhNzg3Yzk1MmI3MSIsImNlOTdhMDJkLTJiYjgtNGE5Yy04NmNiLWI2MWNhMDI3MzlkNCIsIjZlOGYxM2JkLWYwMGMtNDEyMS1hNmUzLWZlYThmMmU2ZjM4ZiIsIjU3OTgzNjQ2LWMxYmYtNDFiYS1iZTc3LWI4MGI5MGIzNDViNyIsIjkxNWEyMjVhLWU2ZWQtNDJjMi05ODg0LTFmZmYyMGJkOGQ5YSIsIjE0ODQyYTg4LThjZDUtNGViNi1iNTI5LTJkMDMwN2I4YjdlZiIsImU4YjVmMTY0LTcwNGQtNGE0NC05NzlkLTNlNjAzMTRhNjUyOSIsIjIxYWRkMmY3LTQ0ODAtNDU4Zi1hZDZiLTBjYTE4OTU2Y2NmZSIsIjg2YjkyYzA3LTdkYWEtNDY0OS04MTEyLTlhNmVmNTY5NjJmYiIsIjJhZDNjNjA5LWM0NTMtNDExZC1iODNlLWI5YWRkZjg5YmQzZiIsImQ0MTc4OWNjLWJjYzQtNDc0MC1hMDVmLWJlOGQ1ZjZlMjM4YyIsImY2ZmJkNGQwLWZlOTItNDkxMi05OTllLTdjYmU3YTI3MTY1MyIsIjVlYjE0YmNhLTY4NjItNGNjYi1iOGFlLThiNThlYmU2ZDBmOCIsIjk4YmQ0ODJiLTczOTQtNGE4Zi04MDIyLWY5OGFjMDVjMjU3ZiIsIjQ5MWQ1MTIyLWFkNjMtNDA1Ny05MWQ0LTZkY2ViZGViZTMwZCIsIjczMjRjNWQwLWU2NzYtNDFlOC04Yjg1LWFjZDIzNTljOWFhNSIsImMwNTFjYzlhLTZmM2EtNDg2MC1hNzRmLTllOWZiYjdhN2ExOCIsIjRkOWM5YjFkLWNlYzYtNGZhNy05ZWE1LWMxYTgwZGYyNWFmMSIsIjM2YWI4NjZjLTgwZTYtNDg3Yi04OTg3LTdkNDVmYzEyZjc3YSIsIjI1OTk3Y2NiLWE2ZWYtNGQ1Zi1iYjE3LTRiYzBmMzliYmE2ZiIsImEyNWUwN2Y2LTA5MDItNDUxMC05MjRlLTA0MjNjMzU0NTVlZSIsIjU3NDUxZWRhLThhOGYtNDQ1YS04YmNkLThmMzk1ZTVlMDc0OSIsIjg4YjQ5ZDg0LTc5YjktNGVlOS05ZDQ3LTk0ZmI5YTRiZmUzMyIsIjdmM2Y1NGYxLWNkNTYtNDZkMi1iMWI2LTFjNjZiMzNmM2VmMSIsIjNjNGJkOTg4LTU3NmYtNGNlOS1iNzhiLWVhZWU3N2RiNGNkYSIsImY4NmU2OTExLWFmMDEtNGZiYS1hYWNjLWQ0MzNiZGU5ZGVjYiJdLCJpcGFkZHIiOiIyMTIuMjM3LjEzNS4xMzQiLCJuYW1lIjoiUnVuZSBUaG9yYmVrIiwib2lkIjoiY2ExMDA0ZjktYzgwYy00NTUyLTk2OTEtNGJmZjNiODUwYzhjIiwib25wcmVtX3NpZCI6IlMtMS01LTIxLTI5MDE0ODY1NzQtMjE5NDc1NDQ4Ni0xMDI1NTQyNDUwLTkwOTczIiwicHVpZCI6IjEwMDMyMDAxMkU1OUFBNjciLCJyaCI6IjAuQVFzQVZaTmg5MmRzQUVHYWVCaEg4d2RDNGc1U3pka1hJN1pOcGE1MzhKU1FoYThMQU5RLiIsInNjcCI6InVzZXJfaW1wZXJzb25hdGlvbiIsInN1YiI6Imtid0trNmRqc2pJZTVqTDdXNk9sTFNJVFQ0ZXFkVVk1c2RMeTBBWVVFWFkiLCJ0aWQiOiJmNzYxOTM1NS02YzY3LTQxMDAtOWE3OC0xODQ3ZjMwNzQyZTIiLCJ1bmlxdWVfbmFtZSI6IlhSVVRIQGVuZXJnaW5ldC5kayIsInVwbiI6IlhSVVRIQGVuZXJnaW5ldC5kayIsInV0aSI6ImFlb3lpOGctcjBPYnRzb0pwcGNWQUEiLCJ2ZXIiOiIxLjAifQ.Qfu2Wdu2LkZWLn4TsCnMf9jTTj452lt9gQqarLbPUulLUYVL2ORXbhQtnEjkyKi0wIuPpRTYNbJP7AoRIebKT6oLa1FXPDyko765UlRdJbSq5cYGSNeH-kZzJ3dpasoU3rYlGisc9vax7uFLeTByCFD6m8vl3ndXPDJ2BcCB0cZhApNPi9BzbsM5jjIFQjpf6HfFHuKN5xZH_m8kGLkUfUSRO2FuDlJN4S7WDK1kv9-o_KifdGyS79ckgH5MRtcxR5YinXQ75E5qd-wgxs8myC8_X9AmAXeOFtH51hxRF-rubxPETJSlzxKV2g9gEUUPJNR0NsDesYSZTdH7sDHy7g'
client_auth = ClientAuthorization(access_token=access_token)

egress = Egress(client_auth=client_auth,
                egress_url=config['Egress']['url'],
                dataset_guid=config['Egress']['guid'])


json_response = egress.download_json_file(from_date='2019-02-01',
                                          to_date='2019-02-02')

df = pd.DataFrame(json_response)
df.to_csv('data.csv', index=False)
